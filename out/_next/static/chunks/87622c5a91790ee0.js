(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,51904,55135,e=>{"use strict";e.i(47167);var r=e.i(71645),t=e.i(38843),a=e.i(9583);function o(){return(o=Object.assign.bind()).apply(this,arguments)}let l=r.forwardRef((e,l)=>r.createElement(a.default,o({},e,{ref:l,icon:t.default})));e.s(["EditOutlined",0,l],51904);let n={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"}}]},name:"delete",theme:"outlined"};function s(){return(s=Object.assign.bind()).apply(this,arguments)}let i=r.forwardRef((e,t)=>r.createElement(a.default,s({},e,{ref:t,icon:n})));e.s(["DeleteOutlined",0,i],55135)},64042,31757,e=>{"use strict";e.i(47167);var r=e.i(71645),t=e.i(43794),a=e.i(8206),o=e.i(42064),l=e.i(50073);let n=(0,r.createContext)({});var s=e.i(56570),i=function(e,r){var t={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&0>r.indexOf(a)&&(t[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,a=Object.getOwnPropertySymbols(e);o<a.length;o++)0>r.indexOf(a[o])&&Object.prototype.propertyIsEnumerable.call(e,a[o])&&(t[a[o]]=e[a[o]]);return t};function c(e,t){let[o,l]=r.useState("string"==typeof e?e:"");return r.useEffect(()=>{(()=>{if("string"==typeof e&&l(e),"object"==typeof e)for(let r=0;r<a.responsiveArray.length;r++){let o=a.responsiveArray[r];if(!t||!t[o])continue;let n=e[o];if(void 0!==n)return void l(n)}})()},[JSON.stringify(e),t]),o}let u=r.forwardRef((e,u)=>{let d,f,p,{prefixCls:m,justify:h,align:g,className:y,style:x,children:b,gutter:v=0,wrap:j}=e,S=i(e,["prefixCls","justify","align","className","style","children","gutter","wrap"]),{getPrefixCls:w,direction:C}=r.useContext(o.ConfigContext),O=(0,l.default)(!0,null),_=c(g,O),$=c(h,O),I=w("row",m),[E,k,A]=(0,s.useRowStyle)(I),T=(d=[void 0,void 0],f=Array.isArray(v)?v:[v,void 0],p=O||{xs:!0,sm:!0,md:!0,lg:!0,xl:!0,xxl:!0},f.forEach((e,r)=>{if("object"==typeof e&&null!==e)for(let t=0;t<a.responsiveArray.length;t++){let o=a.responsiveArray[t];if(p[o]&&void 0!==e[o]){d[r]=e[o];break}}else d[r]=e}),d),P=(0,t.default)(I,{[`${I}-no-wrap`]:!1===j,[`${I}-${$}`]:$,[`${I}-${_}`]:_,[`${I}-rtl`]:"rtl"===C},y,k,A),D={};if(null==T?void 0:T[0]){let e="number"==typeof T[0]?`${-(T[0]/2)}px`:`calc(${T[0]} / -2)`;D.marginLeft=e,D.marginRight=e}let[N,F]=T;D.rowGap=F;let R=r.useMemo(()=>({gutter:[N,F],wrap:j}),[N,F,j]);return E(r.createElement(n.Provider,{value:R},r.createElement("div",Object.assign({},S,{className:P,style:Object.assign(Object.assign({},D),x),ref:u}),b)))});e.s(["Row",0,u],64042);var d=function(e,r){var t={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&0>r.indexOf(a)&&(t[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,a=Object.getOwnPropertySymbols(e);o<a.length;o++)0>r.indexOf(a[o])&&Object.prototype.propertyIsEnumerable.call(e,a[o])&&(t[a[o]]=e[a[o]]);return t};function f(e){return"auto"===e?"1 1 auto":"number"==typeof e?`${e} ${e} auto`:/^\d+(\.\d+)?(px|em|rem|%)$/.test(e)?`0 0 ${e}`:e}let p=["xs","sm","md","lg","xl","xxl"],m=r.forwardRef((e,a)=>{let{getPrefixCls:l,direction:i}=r.useContext(o.ConfigContext),{gutter:c,wrap:u}=r.useContext(n),{prefixCls:m,span:h,order:g,offset:y,push:x,pull:b,className:v,children:j,flex:S,style:w}=e,C=d(e,["prefixCls","span","order","offset","push","pull","className","children","flex","style"]),O=l("col",m),[_,$,I]=(0,s.useColStyle)(O),E={},k={};p.forEach(r=>{let t={},a=e[r];"number"==typeof a?t.span=a:"object"==typeof a&&(t=a||{}),delete C[r],k=Object.assign(Object.assign({},k),{[`${O}-${r}-${t.span}`]:void 0!==t.span,[`${O}-${r}-order-${t.order}`]:t.order||0===t.order,[`${O}-${r}-offset-${t.offset}`]:t.offset||0===t.offset,[`${O}-${r}-push-${t.push}`]:t.push||0===t.push,[`${O}-${r}-pull-${t.pull}`]:t.pull||0===t.pull,[`${O}-rtl`]:"rtl"===i}),t.flex&&(k[`${O}-${r}-flex`]=!0,E[`--${O}-${r}-flex`]=f(t.flex))});let A=(0,t.default)(O,{[`${O}-${h}`]:void 0!==h,[`${O}-order-${g}`]:g,[`${O}-offset-${y}`]:y,[`${O}-push-${x}`]:x,[`${O}-pull-${b}`]:b},v,k,$,I),T={};if(null==c?void 0:c[0]){let e="number"==typeof c[0]?`${c[0]/2}px`:`calc(${c[0]} / 2)`;T.paddingLeft=e,T.paddingRight=e}return S&&(T.flex=f(S),!1!==u||T.minWidth||(T.minWidth=0)),_(r.createElement("div",Object.assign({},C,{style:Object.assign(Object.assign(Object.assign({},T),w),E),className:A,ref:a}),j))});e.s(["default",0,m],31757)},99133,e=>{"use strict";var r=e.i(27494);e.s(["Select",()=>r.default])},63645,e=>{"use strict";var r=e.i(31795),t=e.i(20835);e.s(["parkingService",0,{list:async(e=1,a=10,o="")=>{try{return await t.api.get(r.API_ENDPOINTS.PARKING.LIST.replace("{page}",e).replace("{page_size}",a).replace("{query}",o))}catch(e){throw e}},list_available:async()=>{try{return await t.api.get(r.API_ENDPOINTS.PARKING.LIST_AVAILABLE)}catch(e){throw e}}}])},57781,e=>{"use strict";var r=e.i(43476),t=e.i(11451),a=e.i(64571),o=e.i(71645),l=e.i(20835),n=e.i(932),s=e.i(91542),i=e.i(51904),c=e.i(55135),u=e.i(28685),d=e.i(22315);let f=e=>{let t,o,l,i,c,u,f,g,y,x,b,v,j,S,w,C,O,_=(0,n.c)(31),{data:$,loading:I,currentPage:E,totalResults:k,pageSize:A,onTableChange:T,callback1:P,callback2:D}=e;_[0]!==P?(t=async(e,r)=>{await P(e,r)},_[0]=P,_[1]=t):t=_[1];let N=t;_[2]!==D?(o=()=>{D()},_[2]=D,_[3]=o):o=_[3];let F=o;_[4]===Symbol.for("react.memo_cache_sentinel")?(l={title:"ID",dataIndex:"id",key:"id"},i={title:"Trabajador",dataIndex:"fullname",key:"fullname"},c={title:"Empresa",dataIndex:"company",key:"company"},u={title:"H. Ingreso",dataIndex:"hora_ingreso",key:"hora_ingreso"},f={title:"F. Ingreso",dataIndex:"fecha_ingreso",key:"fecha_ingreso"},_[4]=l,_[5]=i,_[6]=c,_[7]=u,_[8]=f):(l=_[4],i=_[5],c=_[6],u=_[7],f=_[8]),_[9]!==N?(g={title:"H. Salida",dataIndex:"hora_salida",render:(e,t)=>t.hora_salida?t.hora_salida:(0,r.jsx)(a.Button,{size:"small",style:{backgroundColor:"gray",color:"white"},onClick:()=>{N({hora_salida:(0,d.default)().format("HH:mm:ss"),fecha_salida:(0,d.default)().format("YYYY-MM-DD")},t.id)},children:"Marcar"})},_[9]=N,_[10]=g):g=_[10],_[11]===Symbol.for("react.memo_cache_sentinel")?(x={title:"F. Salida",dataIndex:"fecha_salida",key:"fecha_salida"},y={title:"Placa",dataIndex:"placa",key:"placa"},_[11]=y,_[12]=x):(y=_[11],x=_[12]),_[13]!==F?(b={title:"#Parqueo",dataIndex:"n_parqueo",render:(e,t)=>!t.n_parque&&t.placa?(0,r.jsx)(a.Button,{size:"small",onClick:F,style:{backgroundColor:"gray",color:"white"},children:"Agregar"}):t.n_parque},_[13]=F,_[14]=b):b=_[14],_[15]===Symbol.for("react.memo_cache_sentinel")?(v={title:"Motivo",dataIndex:"motivo",key:"motivo"},j={title:"Acciones",key:"acciones",render:p},_[15]=v,_[16]=j):(v=_[15],j=_[16]),_[17]!==b||_[18]!==g?(S=[l,i,c,u,f,g,x,y,b,v,j],_[17]=b,_[18]=g,_[19]=S):S=_[19];let R=S;return _[20]!==E||_[21]!==A||_[22]!==k?(w={current:E,pageSize:A,total:k,showSizeChanger:!1,showTotal:h},_[20]=E,_[21]=A,_[22]=k,_[23]=w):w=_[23],_[24]===Symbol.for("react.memo_cache_sentinel")?(C={x:"max-content"},_[24]=C):C=_[24],_[25]!==R||_[26]!==$||_[27]!==I||_[28]!==T||_[29]!==w?(O=(0,r.jsx)(s.Table,{columns:R,dataSource:$,rowKey:m,loading:I,size:"small",pagination:w,scroll:C,onChange:T}),_[25]=R,_[26]=$,_[27]=I,_[28]=T,_[29]=w,_[30]=O):O=_[30],O};function p(e,t){return(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-around"},children:[(0,r.jsx)(i.EditOutlined,{style:{color:"green"}}),(0,r.jsx)(c.DeleteOutlined,{style:{color:"red"}}),(0,r.jsx)(u.SearchOutlined,{style:{color:"blue"}})]})}function m(e){return`${e.id}`}function h(e){return`Total ${e} registros`}var g=e.i(8613),y=e.i(82717),x=e.i(87789),b=e.i(99133),v=e.i(12931),j=e.i(58962),S=e.i(3240),w=e.i(58652),C=e.i(28546),O=e.i(70158),_=e.i(31795);let $=({isModalOpen:e,onCancel:n,loading:s,fetchAttendanceData:i,currentPage:c})=>{let[u]=g.Form.useForm(),{message:f}=j.App.useApp(),{user:p}=(0,o.useContext)(w.AuthContext),[m,h]=(0,o.useState)(!1),[$,I]=(0,o.useState)([]),E=(0,o.useCallback)(async(e="")=>{try{let r=await C.collaboratorService.search(e);I(r.data)}catch(e){console.error("Error fetching collaborators:",e),I([])}},[]);(0,o.useEffect)(()=>{e&&(u.resetFields(),u.setFieldsValue({fecha_ingreso:(0,d.default)(),hora_ingreso:(0,d.default)(),motivo:"LABORAR"}))},[e,u]);let k=async e=>{try{let r=(0,d.default)().format("YYYY-MM-DD"),t=(0,d.default)().format("HH:mm:ss"),a=await l.api.post(_.API_ENDPOINTS.ATTENDANCE.CREATE,{barcode_value:e,usuario:p.id,fecha_ingreso:r,hora_ingreso:t});if(!a.success)return f.error(a.error||"Error al registrar la asistencia"),!1;return f.success(a.message||"Asistencia registrada exitosamente"),!0}catch(e){return console.error("Error en sendBarcode:",e),f.error("Error de conexión al registrar asistencia"),!1}},A=async e=>{try{let r={...e,usuario:p.id,fecha_ingreso:e.fecha_ingreso?e.fecha_ingreso.format("YYYY-MM-DD"):null,hora_ingreso:e.hora_ingreso?e.hora_ingreso.format("HH:mm:ss"):null,trabajador:e.trabajador.value},t=await C.collaboratorService.create(r);if(!t.success)return void f.error(t.error);f.success(t.message),n(),i(c)}catch(e){console.error("Error submitting attendance data:",e),f.error("Error al enviar los datos de asistencia")}},T=(0,o.useCallback)(async e=>{try{await k(e)&&i(c)}catch(e){console.error("Error en onScanSuccess:",e),f.error("Error al procesar el escaneo")}},[k]),P=async e=>{e.trim().length>3&&E(e)};return(0,r.jsxs)(v.Modal,{open:e,title:"Registrar Asistencia",onCancel:n,onOk:()=>u.submit(),confirmLoading:s,okText:"Registrar",cancelText:"Cancelar",children:[(0,r.jsxs)(g.Form,{form:u,layout:"vertical",onFinish:A,children:[(0,r.jsxs)("div",{style:{flexDirection:"row",display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:"10px"},children:[(0,r.jsx)(g.Form.Item,{name:"trabajador",label:"Trabajador",rules:[{required:!0,message:"Por favor selecciona un trabajador!"}],style:{flex:1,marginBottom:0},children:(0,r.jsx)(b.Select,{showSearch:!0,placeholder:"Selecciona un trabajador",filterOption:!1,fieldNames:{label:"fullname",value:"id"},options:$,onSearch:e=>{P(e)},notFoundContent:"No se encontraron resultados"})}),(0,r.jsx)(a.Button,{onClick:()=>{h(!0)},style:{marginTop:30},icon:(0,r.jsx)(S.QrcodeOutlined,{}),type:"primary"})]}),(0,r.jsx)(g.Form.Item,{name:"fecha_ingreso",label:"Fecha de Ingreso",rules:[{required:!0,message:"Por favor selecciona la fecha de ingreso!"}],children:(0,r.jsx)(y.DatePicker,{style:{width:"100%"},format:"YYYY-MM-DD"})}),(0,r.jsx)(g.Form.Item,{name:"hora_ingreso",label:"Hora de Ingreso",rules:[{required:!0,message:"Por favor selecciona la hora de ingreso!"}],children:(0,r.jsx)(x.TimePicker,{style:{width:"100%"},format:"HH:mm:ss"})}),(0,r.jsx)(g.Form.Item,{name:"motivo",label:"Motivo (Opcional)",children:(0,r.jsx)(t.Input.TextArea,{rows:2})}),(0,r.jsx)(g.Form.Item,{name:"vehiculo",label:"Vehículo (Opcional)",children:(0,r.jsx)(t.Input,{})}),(0,r.jsx)(g.Form.Item,{name:"placa",label:"Placa (Opcional)",children:(0,r.jsx)(t.Input,{})})]}),(0,r.jsx)(v.Modal,{title:"Escanear Código de Barras",open:m,onCancel:()=>{h(!1)},footer:null,width:500,centered:!0,children:(0,r.jsx)("div",{style:{width:"100%",height:350},children:(0,r.jsx)(O.default,{qrCodeContainerId:"qr-code-full-region",onScanSuccess:T,onScanError:e=>{console.warn(`Code scan error = ${e}`)},isModalOpen:e})})})]})},I=async(e,r)=>{try{return await l.api.patch(_.API_ENDPOINTS.ATTENDANCE.PATCH.replace("{pk}",r),e)}catch(e){throw e}},E=e=>{let t,a,o,l,s=(0,n.c)(9),{isOpen:i,handleOk:c,handleCancel:u,data:d}=e;return g.Form.useForm(),s[0]===Symbol.for("react.memo_cache_sentinel")?(t=[{required:!0,message:"Selecciona un parqueo"}],s[0]=t):t=s[0],s[1]===Symbol.for("react.memo_cache_sentinel")?(a={label:"full_status",value:"id"},s[1]=a):a=s[1],s[2]!==d?(o=(0,r.jsx)(g.Form,{children:(0,r.jsx)(g.Form.Item,{name:"number_parking",label:"Número de parque",rules:t,children:(0,r.jsx)(b.Select,{placeholder:"Selecciona un parqueo",options:d,fieldNames:a,showSearch:!0,filterOption:k})})}),s[2]=d,s[3]=o):o=s[3],s[4]!==u||s[5]!==c||s[6]!==i||s[7]!==o?(l=(0,r.jsx)(v.Modal,{open:i,title:"Seleccine numero de parqueo",onCancel:u,onOk:c,okText:"Registrar",onCancelText:"Cancelar",children:o}),s[4]=u,s[5]=c,s[6]=i,s[7]=o,s[8]=l):l=s[8],l};function k(e,r){let t=e.toLowerCase(),a=(r?.full_status??"").toLowerCase(),o=(r?.id??"").toString().toLowerCase();return a.includes(t)||o.includes(t)}var A=e.i(63645);function T(){let{message:e}=j.App.useApp(),[n,s]=(0,o.useState)([]),[i,c]=(0,o.useState)(1),[u,d]=(0,o.useState)(0),[p,m]=(0,o.useState)(!1),[h,g]=(0,o.useState)(""),y=(0,o.useRef)(null),[x,b]=(0,o.useState)(!1),[v,S]=(0,o.useState)(!1),[w,C]=(0,o.useState)(!1),[O,_]=(0,o.useState)([]),k=(0,o.useCallback)(async(e,r="")=>{m(!0);try{let t=await l.api.get(`/v1/attendance/list/?page=${e}&page_size=15&query=${r}`);s(t.results),d(t.count)}catch(e){console.error("Error fetching attendance data:",e),s([]),d(0)}finally{m(!1)}},[15]),T=async()=>{let r=await A.parkingService.list_available();r.success?_(r.data):e.error(r.error)};(0,o.useEffect)(()=>{T()},[]);let P=(0,o.useCallback)(async e=>{let r=e.toLowerCase();if(""===r.trim())return void k(i);let t=n.filter(e=>{let t=e.fullname?String(e.fullname).toLowerCase():"",a=e.company?String(e.company).toLowerCase():"";return t.includes(r)||a.includes(r)});0===t.length?k(i,e):s(t)},[n,k,i]);(0,o.useEffect)(()=>{k(i)},[i,k]),(0,o.useEffect)(()=>{let e,r="",t=t=>{x&&(clearTimeout(e),"Enter"===t.key?(t.preventDefault(),r&&(g(r),P(r),r="")):r+=t.key,e=setTimeout(()=>{r=""},100))};return document.addEventListener("keydown",t),()=>{document.removeEventListener("keydown",t),clearTimeout(e)}},[x,P]);let D=async(r,t)=>{m(!0);let a=await I(r,t);a.success?(e.success(a.message),k(i)):e.error(a.error)};return(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",flexDirection:"row",justifyContent:"space-between"},children:[(0,r.jsx)("h3",{children:"Listado Ingresos y Salidas"}),(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"end",gap:8},children:[(0,r.jsx)(a.Button,{onClick:()=>{S(!0)},children:"Agregar"}),(0,r.jsx)(t.Input,{ref:y,placeholder:"Buscar",value:h,onChange:e=>{g(e.target.value),P(e.target.value)},onFocus:()=>b(!0),onBlur:()=>b(!1)})]})]}),(0,r.jsx)(f,{data:n,loading:p,currentPage:i,totalResults:u,pageSize:15,onTableChange:e=>{c(e.current)},callback1:D,callback2:()=>{C(!0)}}),(0,r.jsx)($,{isModalOpen:v,onCancel:()=>{S(!1)},loading:p,fetchAttendanceData:k,currentPage:i}),(0,r.jsx)(E,{isOpen:w,handleOk:()=>{},handleCancel:()=>C(!1),data:O})]})}e.s(["default",()=>T],57781)}]);
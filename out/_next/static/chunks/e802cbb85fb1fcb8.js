(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,51904,55135,e=>{"use strict";e.i(47167);var r=e.i(71645),t=e.i(38843),a=e.i(9583);function o(){return(o=Object.assign.bind()).apply(this,arguments)}let l=r.forwardRef((e,l)=>r.createElement(a.default,o({},e,{ref:l,icon:t.default})));e.s(["EditOutlined",0,l],51904);let n={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"}}]},name:"delete",theme:"outlined"};function s(){return(s=Object.assign.bind()).apply(this,arguments)}let i=r.forwardRef((e,t)=>r.createElement(a.default,s({},e,{ref:t,icon:n})));e.s(["DeleteOutlined",0,i],55135)},64042,31757,e=>{"use strict";e.i(47167);var r=e.i(71645),t=e.i(43794),a=e.i(8206),o=e.i(42064),l=e.i(50073);let n=(0,r.createContext)({});var s=e.i(56570),i=function(e,r){var t={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&0>r.indexOf(a)&&(t[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,a=Object.getOwnPropertySymbols(e);o<a.length;o++)0>r.indexOf(a[o])&&Object.prototype.propertyIsEnumerable.call(e,a[o])&&(t[a[o]]=e[a[o]]);return t};function c(e,t){let[o,l]=r.useState("string"==typeof e?e:"");return r.useEffect(()=>{(()=>{if("string"==typeof e&&l(e),"object"==typeof e)for(let r=0;r<a.responsiveArray.length;r++){let o=a.responsiveArray[r];if(!t||!t[o])continue;let n=e[o];if(void 0!==n)return void l(n)}})()},[JSON.stringify(e),t]),o}let u=r.forwardRef((e,u)=>{let d,f,p,{prefixCls:m,justify:h,align:g,className:y,style:x,children:b,gutter:v=0,wrap:j}=e,w=i(e,["prefixCls","justify","align","className","style","children","gutter","wrap"]),{getPrefixCls:S,direction:C}=r.useContext(o.ConfigContext),O=(0,l.default)(!0,null),_=c(g,O),E=c(h,O),$=S("row",m),[I,A,T]=(0,s.useRowStyle)($),k=(d=[void 0,void 0],f=Array.isArray(v)?v:[v,void 0],p=O||{xs:!0,sm:!0,md:!0,lg:!0,xl:!0,xxl:!0},f.forEach((e,r)=>{if("object"==typeof e&&null!==e)for(let t=0;t<a.responsiveArray.length;t++){let o=a.responsiveArray[t];if(p[o]&&void 0!==e[o]){d[r]=e[o];break}}else d[r]=e}),d),P=(0,t.default)($,{[`${$}-no-wrap`]:!1===j,[`${$}-${E}`]:E,[`${$}-${_}`]:_,[`${$}-rtl`]:"rtl"===C},y,A,T),N={};if(null==k?void 0:k[0]){let e="number"==typeof k[0]?`${-(k[0]/2)}px`:`calc(${k[0]} / -2)`;N.marginLeft=e,N.marginRight=e}let[D,R]=k;N.rowGap=R;let M=r.useMemo(()=>({gutter:[D,R],wrap:j}),[D,R,j]);return I(r.createElement(n.Provider,{value:M},r.createElement("div",Object.assign({},w,{className:P,style:Object.assign(Object.assign({},N),x),ref:u}),b)))});e.s(["Row",0,u],64042);var d=function(e,r){var t={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&0>r.indexOf(a)&&(t[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,a=Object.getOwnPropertySymbols(e);o<a.length;o++)0>r.indexOf(a[o])&&Object.prototype.propertyIsEnumerable.call(e,a[o])&&(t[a[o]]=e[a[o]]);return t};function f(e){return"auto"===e?"1 1 auto":"number"==typeof e?`${e} ${e} auto`:/^\d+(\.\d+)?(px|em|rem|%)$/.test(e)?`0 0 ${e}`:e}let p=["xs","sm","md","lg","xl","xxl"],m=r.forwardRef((e,a)=>{let{getPrefixCls:l,direction:i}=r.useContext(o.ConfigContext),{gutter:c,wrap:u}=r.useContext(n),{prefixCls:m,span:h,order:g,offset:y,push:x,pull:b,className:v,children:j,flex:w,style:S}=e,C=d(e,["prefixCls","span","order","offset","push","pull","className","children","flex","style"]),O=l("col",m),[_,E,$]=(0,s.useColStyle)(O),I={},A={};p.forEach(r=>{let t={},a=e[r];"number"==typeof a?t.span=a:"object"==typeof a&&(t=a||{}),delete C[r],A=Object.assign(Object.assign({},A),{[`${O}-${r}-${t.span}`]:void 0!==t.span,[`${O}-${r}-order-${t.order}`]:t.order||0===t.order,[`${O}-${r}-offset-${t.offset}`]:t.offset||0===t.offset,[`${O}-${r}-push-${t.push}`]:t.push||0===t.push,[`${O}-${r}-pull-${t.pull}`]:t.pull||0===t.pull,[`${O}-rtl`]:"rtl"===i}),t.flex&&(A[`${O}-${r}-flex`]=!0,I[`--${O}-${r}-flex`]=f(t.flex))});let T=(0,t.default)(O,{[`${O}-${h}`]:void 0!==h,[`${O}-order-${g}`]:g,[`${O}-offset-${y}`]:y,[`${O}-push-${x}`]:x,[`${O}-pull-${b}`]:b},v,A,E,$),k={};if(null==c?void 0:c[0]){let e="number"==typeof c[0]?`${c[0]/2}px`:`calc(${c[0]} / 2)`;k.paddingLeft=e,k.paddingRight=e}return w&&(k.flex=f(w),!1!==u||k.minWidth||(k.minWidth=0)),_(r.createElement("div",Object.assign({},C,{style:Object.assign(Object.assign(Object.assign({},k),S),I),className:T,ref:a}),j))});e.s(["default",0,m],31757)},99133,e=>{"use strict";var r=e.i(27494);e.s(["Select",()=>r.default])},63645,e=>{"use strict";var r=e.i(31795),t=e.i(20835);e.s(["parkingService",0,{list:async(e=1,a=10,o="")=>{try{return await t.api.get(r.API_ENDPOINTS.PARKING.LIST.replace("{page}",e).replace("{page_size}",a).replace("{query}",o))}catch(e){throw e}},list_available:async()=>{try{return await t.api.get(r.API_ENDPOINTS.PARKING.LIST_AVAILABLE)}catch(e){throw e}}}])},57781,e=>{"use strict";var r=e.i(43476),t=e.i(11451),a=e.i(64571),o=e.i(71645),l=e.i(20835),n=e.i(932),s=e.i(91542),i=e.i(51904),c=e.i(55135),u=e.i(28685),d=e.i(22315),f=e.i(31795);let p=async e=>{try{return await l.api.post(f.API_ENDPOINTS.ATTENDANCE.CREATE,e)}catch(e){throw e}},m=async(e,r)=>{try{return await l.api.patch(f.API_ENDPOINTS.ATTENDANCE.PATCH.replace("{pk}",r),e)}catch(e){throw e}},h=async e=>{try{return await l.api.get(f.API_ENDPOINTS.ATTENDANCE.PATCH.replace("{pk}",e))}catch(e){throw e}},g=e=>{let t,o,l,f,p,m,g,b,v,j,w,S,C,O,_,E,$,I=(0,n.c)(34),{data:A,loading:T,currentPage:k,totalResults:P,pageSize:N,onTableChange:D,callback1:R,callback2:M,isModalOpenEdit:F}=e;I[0]!==R?(t=async(e,r)=>{await R(e,r)},I[0]=R,I[1]=t):t=I[1];let H=t;I[2]!==M?(o=()=>{M()},I[2]=M,I[3]=o):o=I[3];let L=o;I[4]!==F?(l=async e=>{F((await h(e)).data)},I[4]=F,I[5]=l):l=I[5];let q=l;I[6]!==q?(f={title:"Acciones",key:"acciones",render:(e,t)=>(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-around"},children:[(0,r.jsx)(i.EditOutlined,{style:{color:"green"},onClick:()=>q(t.id)}),(0,r.jsx)(c.DeleteOutlined,{style:{color:"red"}}),(0,r.jsx)(u.SearchOutlined,{style:{color:"blue"}})]})},I[6]=q,I[7]=f):f=I[7],I[8]===Symbol.for("react.memo_cache_sentinel")?(p={title:"Trabajador",dataIndex:"fullname",key:"fullname"},m={title:"Empresa",dataIndex:"company",key:"company"},g={title:"H. Ingreso",dataIndex:"hora_ingreso",key:"hora_ingreso"},b={title:"F. Ingreso",dataIndex:"fecha_ingreso",key:"fecha_ingreso"},I[8]=p,I[9]=m,I[10]=g,I[11]=b):(p=I[8],m=I[9],g=I[10],b=I[11]),I[12]!==H?(v={title:"H. Salida",dataIndex:"hora_salida",render:(e,t)=>t.hora_salida?t.hora_salida:(0,r.jsx)(a.Button,{size:"small",style:{backgroundColor:"gray",color:"white"},onClick:()=>{H({hora_salida:(0,d.default)().format("HH:mm:ss"),fecha_salida:(0,d.default)().format("YYYY-MM-DD")},t.id)},children:"Marcar"})},I[12]=H,I[13]=v):v=I[13],I[14]===Symbol.for("react.memo_cache_sentinel")?(j={title:"F. Salida",dataIndex:"fecha_salida",key:"fecha_salida"},w={title:"Placa",dataIndex:"placa",key:"placa"},I[14]=j,I[15]=w):(j=I[14],w=I[15]),I[16]!==L?(S={title:"#Parqueo",dataIndex:"n_parqueo",render:(e,t)=>!t.n_parque&&t.placa?(0,r.jsx)(a.Button,{size:"small",onClick:L,style:{backgroundColor:"gray",color:"white"},children:"Agregar"}):t.n_parque},I[16]=L,I[17]=S):S=I[17],I[18]===Symbol.for("react.memo_cache_sentinel")?(C={title:"Motivo",dataIndex:"motivo",key:"motivo"},I[18]=C):C=I[18],I[19]!==S||I[20]!==f||I[21]!==v?(O=[f,p,m,g,b,v,j,w,S,C],I[19]=S,I[20]=f,I[21]=v,I[22]=O):O=I[22];let Y=O;return I[23]!==k||I[24]!==N||I[25]!==P?(_={current:k,pageSize:N,total:P,showSizeChanger:!1,showTotal:x},I[23]=k,I[24]=N,I[25]=P,I[26]=_):_=I[26],I[27]===Symbol.for("react.memo_cache_sentinel")?(E={x:"max-content"},I[27]=E):E=I[27],I[28]!==Y||I[29]!==A||I[30]!==T||I[31]!==D||I[32]!==_?($=(0,r.jsx)(s.Table,{columns:Y,dataSource:A,rowKey:y,loading:T,size:"small",pagination:_,scroll:E,onChange:D}),I[28]=Y,I[29]=A,I[30]=T,I[31]=D,I[32]=_,I[33]=$):$=I[33],$};function y(e){return`${e.id}`}function x(e){return`Total ${e} registros`}var b=e.i(8613),v=e.i(82717),j=e.i(87789),w=e.i(99133),S=e.i(12931),C=e.i(58962),O=e.i(3240),_=e.i(58652),E=e.i(28546),$=e.i(70158);let I=({isModalOpen:e,onCancel:n,loading:s,fetchAttendanceData:i,currentPage:c,data:u})=>{let[m]=b.Form.useForm(),{message:h}=C.App.useApp(),{user:g}=(0,o.useContext)(_.AuthContext),[y,x]=(0,o.useState)(!1),[I,A]=(0,o.useState)([]),T=(0,o.useCallback)(async(e="")=>{try{let r=await E.collaboratorService.search(e);A(r.data)}catch(e){console.error("Error fetching collaborators:",e),A([])}},[]);(0,o.useEffect)(()=>{if(e){m.resetFields();let e={};u?.trabajador&&(e.fecha_ingreso=(0,d.default)(u.fecha_ingreso),e.hora_ingreso=(0,d.default)(u.hora_ingreso,"HH:mm:ss"),e.trabajador={label:u.fullname,value:u.trabajador},e.motivo=u.motivo,e.placa=u.placa),m.setFieldsValue({fecha_ingreso:(0,d.default)(),hora_ingreso:(0,d.default)(),motivo:"LABORAR",...e})}},[e,m]);let k=async e=>{try{let r=(0,d.default)().format("YYYY-MM-DD"),t=(0,d.default)().format("HH:mm:ss"),a=await l.api.post(f.API_ENDPOINTS.ATTENDANCE.CREATE,{barcode_value:e,usuario:g.id,fecha_ingreso:r,hora_ingreso:t});if(!a.success)return h.error(a.error||"Error al registrar la asistencia"),!1;return h.success(a.message||"Asistencia registrada exitosamente"),!0}catch(e){return console.error("Error en sendBarcode:",e),h.error("Error de conexión al registrar asistencia"),!1}},P=async e=>{try{let r={...e,usuario:g.id,fecha_ingreso:e.fecha_ingreso?e.fecha_ingreso.format("YYYY-MM-DD"):null,hora_ingreso:e.hora_ingreso?e.hora_ingreso.format("HH:mm:ss"):null,trabajador:e.trabajador},t=await p(r);if(!t.success)return void h.error(t.error);h.success(t.message),n(),i(c)}catch(e){h.error("Error al enviar los datos de asistencia")}},N=(0,o.useCallback)(async e=>{try{await k(e)&&i(c)}catch(e){console.error("Error en onScanSuccess:",e),h.error("Error al procesar el escaneo")}},[k]),D=async e=>{e.trim().length>3&&T(e)};return(0,r.jsxs)(S.Modal,{open:e,title:"Registrar Asistencia",onCancel:n,onOk:()=>m.submit(),confirmLoading:s,okText:"Registrar",cancelText:"Cancelar",children:[(0,r.jsxs)(b.Form,{form:m,layout:"vertical",onFinish:P,children:[(0,r.jsxs)("div",{style:{flexDirection:"row",display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:"10px"},children:[(0,r.jsx)(b.Form.Item,{name:"trabajador",label:"Trabajador",rules:[{required:!0,message:"Por favor selecciona un trabajador!"}],style:{flex:1,marginBottom:0},children:(0,r.jsx)(w.Select,{showSearch:!0,placeholder:"Selecciona un trabajador",filterOption:!1,fieldNames:{label:"fullname",value:"id"},options:I,onSearch:e=>{D(e)},notFoundContent:"No se encontraron resultados"})}),(0,r.jsx)(a.Button,{onClick:()=>{x(!0)},style:{marginTop:30},icon:(0,r.jsx)(O.QrcodeOutlined,{}),type:"primary"})]}),(0,r.jsx)(b.Form.Item,{name:"fecha_ingreso",label:"Fecha de Ingreso",rules:[{required:!0,message:"Por favor selecciona la fecha de ingreso!"}],children:(0,r.jsx)(v.DatePicker,{style:{width:"100%"},format:"YYYY-MM-DD"})}),(0,r.jsx)(b.Form.Item,{name:"hora_ingreso",label:"Hora de Ingreso",rules:[{required:!0,message:"Por favor selecciona la hora de ingreso!"}],children:(0,r.jsx)(j.TimePicker,{style:{width:"100%"},format:"HH:mm:ss"})}),(0,r.jsx)(b.Form.Item,{name:"motivo",label:"Motivo (Opcional)",children:(0,r.jsx)(t.Input.TextArea,{rows:2})}),(0,r.jsx)(b.Form.Item,{name:"vehiculo",label:"Vehículo (Opcional)",children:(0,r.jsx)(t.Input,{})}),(0,r.jsx)(b.Form.Item,{name:"placa",label:"Placa (Opcional)",children:(0,r.jsx)(t.Input,{})})]}),(0,r.jsx)(S.Modal,{title:"Escanear Código de Barras",open:y,onCancel:()=>{x(!1)},footer:null,width:500,centered:!0,children:(0,r.jsx)("div",{style:{width:"100%",height:350},children:(0,r.jsx)($.default,{qrCodeContainerId:"qr-code-full-region",onScanSuccess:N,onScanError:e=>{console.warn(`Code scan error = ${e}`)},isModalOpen:e})})})]})},A=e=>{let t,a,o,l,s=(0,n.c)(9),{isOpen:i,handleOk:c,handleCancel:u,data:d}=e;return s[0]===Symbol.for("react.memo_cache_sentinel")?(t=[{required:!0,message:"Selecciona un parqueo"}],s[0]=t):t=s[0],s[1]===Symbol.for("react.memo_cache_sentinel")?(a={label:"full_status",value:"id"},s[1]=a):a=s[1],s[2]!==d?(o=(0,r.jsx)(b.Form,{children:(0,r.jsx)(b.Form.Item,{name:"number_parking",label:"Número de parque",rules:t,children:(0,r.jsx)(w.Select,{placeholder:"Selecciona un parqueo",options:d,fieldNames:a,showSearch:!0,filterOption:T})})}),s[2]=d,s[3]=o):o=s[3],s[4]!==u||s[5]!==c||s[6]!==i||s[7]!==o?(l=(0,r.jsx)(S.Modal,{open:i,title:"Seleccine numero de parqueo",onCancel:u,onOk:c,okText:"Registrar",onCancelText:"Cancelar",children:o}),s[4]=u,s[5]=c,s[6]=i,s[7]=o,s[8]=l):l=s[8],l};function T(e,r){let t=e.toLowerCase(),a=(r?.full_status??"").toLowerCase(),o=(r?.id??"").toString().toLowerCase();return a.includes(t)||o.includes(t)}var k=e.i(63645);function P(){let{message:e}=C.App.useApp(),[n,s]=(0,o.useState)([]),[i,c]=(0,o.useState)(1),[u,d]=(0,o.useState)(0),[f,p]=(0,o.useState)(!1),[h,y]=(0,o.useState)(""),x=(0,o.useRef)(null),[b,v]=(0,o.useState)(!1),[j,w]=(0,o.useState)(!1),[S,O]=(0,o.useState)(!1),[_,E]=(0,o.useState)([]),[$,T]=(0,o.useState)(!1),[P,N]=(0,o.useState)({}),D=(0,o.useCallback)(async(e,r="")=>{p(!0);try{let t=await l.api.get(`/v1/attendance/list/?page=${e}&page_size=15&query=${r}`);s(t.results),d(t.count)}catch(e){console.error("Error fetching attendance data:",e),s([]),d(0)}finally{p(!1)}},[15]),R=async()=>{let r=await k.parkingService.list_available();r.success?E(r.data):e.error(r.error)};(0,o.useEffect)(()=>{R()},[]);let M=(0,o.useCallback)(async e=>{let r=e.toLowerCase();if(""===r.trim())return void D(i);let t=n.filter(e=>{let t=e.fullname?String(e.fullname).toLowerCase():"",a=e.company?String(e.company).toLowerCase():"";return t.includes(r)||a.includes(r)});0===t.length?D(i,e):s(t)},[n,D,i]);(0,o.useEffect)(()=>{D(i)},[i,D]),(0,o.useEffect)(()=>{let e,r="",t=t=>{b&&(clearTimeout(e),"Enter"===t.key?(t.preventDefault(),r&&(y(r),M(r),r="")):r+=t.key,e=setTimeout(()=>{r=""},100))};return document.addEventListener("keydown",t),()=>{document.removeEventListener("keydown",t),clearTimeout(e)}},[b,M]);let F=async(r,t)=>{p(!0);let a=await m(r,t);a.success?(e.success(a.message),D(i)):e.error(a.error)};return(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",flexDirection:"row",justifyContent:"space-between"},children:[(0,r.jsx)("h3",{children:"Listado Ingresos y Salidas"}),(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"end",gap:8},children:[(0,r.jsx)(a.Button,{onClick:()=>{w(!0)},children:"Agregar"}),(0,r.jsx)(t.Input,{ref:x,placeholder:"Buscar",value:h,onChange:e=>{y(e.target.value),M(e.target.value)},onFocus:()=>v(!0),onBlur:()=>v(!1)})]})]}),(0,r.jsx)(g,{data:n,loading:f,currentPage:i,totalResults:u,pageSize:15,onTableChange:e=>{c(e.current)},callback1:F,callback2:()=>{O(!0)},isModalOpenEdit:e=>{N(e),T(!0),w(!0)}}),(0,r.jsx)(I,{isModalOpen:j,onCancel:()=>{w(!1)},loading:f,fetchAttendanceData:D,currentPage:i,data:P}),(0,r.jsx)(A,{isOpen:S,handleOk:()=>{},handleCancel:()=>O(!1),data:_})]})}e.s(["default",()=>P],57781)}]);